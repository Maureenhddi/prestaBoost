{% extends 'base.html.twig' %}

{% block title %}Paramètres - {{ boutique.name }}{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="/css/dashboard.css?v={{ 'now'|date('YmdHis') }}">
    <style>
        {% if boutique.primaryColor %}
        :root {
            --primary: {{ boutique.primaryColor }};
        }

        body {
            background: linear-gradient(135deg, {{ boutique.primaryColor }} 0%, {{ boutique.primaryColor }}dd 100%);
        }

        body::before {
            background:
                radial-gradient(circle at 20% 50%, {{ boutique.primaryColor }}26 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, {{ boutique.primaryColor }}26 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, {{ boutique.primaryColor }}26 0%, transparent 50%);
        }
        {% endif %}
    </style>
{% endblock %}

{% block navbar %}
<div class="container">
    <nav class="navbar">
        <div class="navbar-brand">
            {% if boutique.logoUrl %}
                <img src="{{ boutique.logoUrl }}" alt="{{ boutique.name }}" style="max-height: 40px;">
            {% else %}
                {{ boutique.name }}
            {% endif %}
        </div>
        <ul class="navbar-menu">
            <li><a href="{{ path('app_dashboard') }}">← Mes Boutiques</a></li>
            <li><a href="{{ path('app_boutique_dashboard', {id: boutique.id}) }}">Dashboard</a></li>
            <li><a href="{{ path('app_boutique_stocks', {id: boutique.id}) }}">Stocks</a></li>
            <li><a href="{{ path('app_boutique_settings', {id: boutique.id}) }}" class="active">Paramètres</a></li>
            {% if app.user.isSuperAdmin() %}
                <li><a href="{{ path('app_users') }}">Utilisateurs</a></li>
            {% endif %}
            <li><a href="{{ path('app_logout') }}">Déconnexion</a></li>
        </ul>
    </nav>
</div>
{% endblock %}

{% block body %}

<div class="settings-container">
    <div class="settings-header">
        <h1>Paramètres de la boutique</h1>
        <p>Personnalisez l'apparence et les informations de votre boutique</p>
    </div>

    <div class="settings-card">
        <form method="post" action="{{ path('app_boutique_settings_update', {id: boutique.id}) }}" enctype="multipart/form-data">
            <div class="settings-section">
                <h2>Informations générales</h2>

                <div class="input-group">
                    <label for="name">Nom de la boutique</label>
                    <input type="text" id="name" name="name" value="{{ boutique.name }}" required>
                </div>

                <div class="input-group">
                    <label for="domain">Domaine</label>
                    <input type="url" id="domain" name="domain" value="{{ boutique.domain }}" required>
                </div>
            </div>

            <div class="settings-section">
                <h2>Personnalisation</h2>

                <div class="input-group">
                    <label for="logo">Logo de la boutique</label>
                    <input type="file" id="logo" name="logo" accept="image/png,image/jpeg,image/jpg,image/svg+xml">
                    <small class="help-text">Le logo sera affiché dans la navigation. Formats acceptés: PNG, JPG, SVG. Taille max: 2MB</small>
                </div>

                {% if boutique.logoUrl %}
                    <div class="logo-preview">
                        <label>Logo actuel</label>
                        <div class="preview-box">
                            <img src="{{ boutique.logoUrl }}" alt="Logo" style="max-height: 100px;">
                        </div>
                    </div>
                {% endif %}

                <div class="input-group">
                    <label for="primaryColor">Couleur primaire</label>
                    <div class="color-picker-group">
                        <input type="color" id="primaryColor" name="primaryColor" value="{{ boutique.primaryColor ?? '#10b981' }}">
                        <input type="text" id="primaryColorHex" value="{{ boutique.primaryColor ?? '#10b981' }}" readonly>
                    </div>
                    <small class="help-text">Cette couleur sera utilisée pour les éléments d'interface de votre boutique</small>
                </div>

                {% if boutique.primaryColor %}
                    <div class="color-preview">
                        <label>Aperçu des couleurs</label>
                        <div class="preview-box">
                            <button type="button" class="btn-preview" style="background-color: {{ boutique.primaryColor }}">Bouton exemple</button>
                            <span class="badge-preview" style="background-color: {{ boutique.primaryColor }}20; color: {{ boutique.primaryColor }}">Badge exemple</span>
                        </div>
                    </div>
                {% endif %}
            </div>

            <div class="settings-actions">
                <a href="{{ path('app_boutique_dashboard', {id: boutique.id}) }}" class="btn btn-secondary">Annuler</a>
                <button type="submit" class="btn btn-primary">Enregistrer les modifications</button>
            </div>
        </form>
    </div>
</div>

<style>
.settings-container {
    max-width: 800px;
    margin: 0 auto;
}

.settings-header {
    text-align: center;
    margin-bottom: 40px;
}

.settings-header h1 {
    font-size: 32px;
    font-weight: 700;
    color: var(--dark-text);
    margin-bottom: 10px;
}

.settings-header p {
    font-size: 16px;
    color: var(--dark-text);
    opacity: 0.6;
}

.settings-card {
    background: white;
    border-radius: 20px;
    padding: 40px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
}

.settings-section {
    margin-bottom: 40px;
    padding-bottom: 40px;
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}

.settings-section:last-of-type {
    border-bottom: none;
}

.settings-section h2 {
    font-size: 20px;
    font-weight: 600;
    color: var(--dark-text);
    margin-bottom: 25px;
}

.input-group {
    margin-bottom: 25px;
}

.help-text {
    display: block;
    font-size: 13px;
    color: var(--dark-text);
    opacity: 0.6;
    margin-top: 8px;
}

.color-picker-group {
    display: flex;
    gap: 15px;
    align-items: center;
}

.color-picker-group input[type="color"] {
    width: 80px;
    height: 50px;
    border: 2px solid var(--surface-dark);
    border-radius: 10px;
    cursor: pointer;
}

.color-picker-group input[type="text"] {
    flex: 1;
    background: var(--surface-light);
}

.logo-preview, .color-preview {
    margin-bottom: 25px;
}

.logo-preview label, .color-preview label {
    display: block;
    font-weight: 600;
    margin-bottom: 10px;
    color: var(--dark-text);
}

.preview-box {
    padding: 20px;
    background: var(--surface-light);
    border-radius: 10px;
    display: flex;
    align-items: center;
    gap: 15px;
}

.btn-preview {
    padding: 12px 24px;
    border: none;
    border-radius: 10px;
    color: white;
    font-weight: 600;
    cursor: default;
}

.badge-preview {
    padding: 8px 16px;
    border-radius: 8px;
    font-weight: 600;
    font-size: 14px;
}

.settings-actions {
    display: flex;
    gap: 15px;
    margin-top: 30px;
}

.settings-actions .btn {
    flex: 1;
}
</style>

<script>
document.getElementById('primaryColor').addEventListener('input', function(e) {
    document.getElementById('primaryColorHex').value = e.target.value;
});
</script>

{% endblock %}
